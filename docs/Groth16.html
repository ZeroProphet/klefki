
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Groth16 in zkp-playground &#8212; zkp-playground 1.0 documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Play MimbleWimble with zkp-playground" href="MimbleWimble.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">

      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>
</div>
</div>
<div class="section" id="Groth16-in-zkp-playground">
<h1>Groth16 in zkp-playground<a class="headerlink" href="#Groth16-in-zkp-playground" title="Permalink to this headline">¶</a></h1>
<div class="section" id="Bilinear-groups">
<h2>Bilinear groups<a class="headerlink" href="#Bilinear-groups" title="Permalink to this headline">¶</a></h2>
<p>We will work over bilinear groups <span class="math notranslate nohighlight">\((p,\mathbb{G}_1,\mathbb{G}_2,\mathbb{G}_T,e,g,h)\)</span> with the following properties:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathbb{G}_1, \mathbb{G}_2, \mathbb{G}_T\)</span> are groups of prime order p</p></li>
<li><p>The pairing <span class="math notranslate nohighlight">\(e\)</span>: <span class="math notranslate nohighlight">\(\mathbb{G}_1x\mathbb{G}_2 \rightarrow \mathbb{G}_T\)</span> is a binlinear map</p></li>
<li><p><span class="math notranslate nohighlight">\(g\)</span> is a generator for <span class="math notranslate nohighlight">\(\mathbb{G}_1\)</span>, <span class="math notranslate nohighlight">\(h\)</span> is a generator for <span class="math notranslate nohighlight">\(\mathbb{G}_2\)</span> and <span class="math notranslate nohighlight">\(e(g, h)\)</span> is a generator for <span class="math notranslate nohighlight">\(\mathbb{G}_T\)</span></p></li>
<li><p>There are efficient algorithms for computing group operations, evaluating the bilinearmap, deciding membership of the groups, deciding equality of group elements andsampling generators of the groups. We refer to these as the generic group operations.</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">zkp_playground.curves.barreto_naehrig.bn128</span> <span class="kn">import</span> <span class="n">BN128ScalarFP</span> <span class="k">as</span> <span class="n">FP</span><span class="p">,</span> <span class="n">ECGBN128</span> <span class="k">as</span> <span class="n">ECG</span>
<span class="kn">from</span> <span class="nn">zkp_playground.algebra.utils</span> <span class="kn">import</span> <span class="n">randfield</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">g</span> <span class="o">=</span> <span class="n">ECG</span><span class="o">.</span><span class="n">G1</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">ECG</span><span class="o">.</span><span class="n">G2</span>
</pre></div>
</div>
</div>
<p>We write <span class="math notranslate nohighlight">\([a]_1\)</span> for <span class="math notranslate nohighlight">\(g^a\)</span>, <span class="math notranslate nohighlight">\([b]_2\)</span> for <span class="math notranslate nohighlight">\(h^b\)</span>, and <span class="math notranslate nohighlight">\([c]_T\)</span> for <span class="math notranslate nohighlight">\(e(g, h)^c\)</span>. A vector of group elements will be represented as <span class="math notranslate nohighlight">\([\mathbf{a}]_i\)</span>. We defined dot product as <span class="math notranslate nohighlight">\([\mathbf{a}]_1 \circ [\mathbf{b}]_2 = [\mathbf{a}\circ \mathbf{b}]_T\)</span></p>
</div>
<div class="section" id="NIZK">
<h2>NIZK<a class="headerlink" href="#NIZK" title="Permalink to this headline">¶</a></h2>
<p>let <span class="math notranslate nohighlight">\(R\)</span> be a relation generator that given a security parameter <span class="math notranslate nohighlight">\(λ\)</span> in unary returns a polynomial time decidable binary relation <span class="math notranslate nohighlight">\(R\)</span>. For pairs <span class="math notranslate nohighlight">\((\phi, \omega) \in R\)</span>.</p>
<p>For pairs <span class="math notranslate nohighlight">\((\phi, \omega) \ in R\)</span>, we call <span class="math notranslate nohighlight">\(\phi\)</span> the statement and <span class="math notranslate nohighlight">\(\omega\)</span> the witness. We defined <span class="math notranslate nohighlight">\(R_{\lambda}\)</span> to be the set of possible relations <span class="math notranslate nohighlight">\(R \)</span>. The relation generator may also output someside information, an auxiliary input <span class="math notranslate nohighlight">\(z\)</span>, which will be given to the adversary.</p>
<p>An efficient prover publicly verifiable non-interactive argument for <span class="math notranslate nohighlight">\(R\)</span> is a quadruple of probabilistic polynomial algorithms <span class="math notranslate nohighlight">\((Setup,Prove,Vfy,Sim)\)</span> such that</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\((\sigma,\tau) \leftarrow Setup(R)\)</span>: The setup produces a common reference stringσand a simulationtrapdoorτfor the relationR</p></li>
<li><p><span class="math notranslate nohighlight">\(\pi \leftarrow Prov(R, \sigma, \phi, \omega)\)</span>:The prover algorithm takes as input a common reference string σ and <span class="math notranslate nohighlight">\((φ,w)∈R\)</span> and returns an argument π.</p></li>
<li><p><span class="math notranslate nohighlight">\(0/1 \leftarrow Vfy(R, \sigma, \phi, \pi)\)</span>: The verification algorithm takes as input a common referencestring σ, a statement φ and an argumentπand returns 0 (reject) or 1 (accept).</p></li>
<li><p><span class="math notranslate nohighlight">\(\pi \leftarrow Sim(R, \tau, \phi)\)</span>: The simulator takes as input a simulation trapdoor and statementφand returns an argument π.</p></li>
</ul>
</div>
<div class="section" id="QAP">
<h2>QAP<a class="headerlink" href="#QAP" title="Permalink to this headline">¶</a></h2>
<p>Given <span class="math notranslate nohighlight">\(n\)</span> equations we pick arbitrary distinct <span class="math notranslate nohighlight">\(r_1,\cdots,r_n \in \mathbb{F}\)</span> and define</p>
<div class="math notranslate nohighlight">
\[t(x) = \prod_{q=1}^n (x - r_q)\]</div>
<div class="math notranslate nohighlight">
\[\sum_{i=0}^m a_i u_i(X) \circ \sum_{i=0}^m a_i v_i(X) = \sum_{i=0}^m a_i w_i(X) + h(X)t(X)\]</div>
<p>we will be working with quadratic arithmetic programsRthat have thefollowing description</p>
<div class="math notranslate nohighlight">
\[R = (p, \mathbb{G}_1,\mathbb{G}_2, \mathbb{G}_T, e, g, h, l, \{u_i(X), v_i(X), w_i(X)\}_{i=0}^n, t(X))\]</div>
<p>with <span class="math notranslate nohighlight">\(|p|=\lambda\)</span>. The realation defineds a field <span class="math notranslate nohighlight">\(\mathbb{Z}_p\)</span> and a language of statement <span class="math notranslate nohighlight">\((a_i,\cdots, a_l) \in \mathbb{Z}_p^l\)</span> and witness <span class="math notranslate nohighlight">\((a_{l+1}, \cdots, a_m) \in \mathbb{Z}_p^{m-l}\)</span> such that with <span class="math notranslate nohighlight">\(a_0=1\)</span></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>

<span class="n">RationalGenerator</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s2">&quot;RelationGenerator&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="s2">&quot;G1&quot;</span><span class="p">,</span> <span class="s2">&quot;G2&quot;</span><span class="p">,</span> <span class="s2">&quot;Gt&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">,</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="s2">&quot;h&quot;</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="s2">&quot;U&quot;</span><span class="p">,</span> <span class="s2">&quot;V&quot;</span><span class="p">,</span> <span class="s2">&quot;W&quot;</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">zkp_playground.zkp.r1cs</span> <span class="kn">import</span> <span class="n">R1CS</span>
<span class="kn">from</span> <span class="nn">zkp_playground.zkp.qap</span> <span class="kn">import</span> <span class="n">QAP</span>

</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nd">@R1CS</span><span class="o">.</span><span class="n">r1cs</span><span class="p">(</span><span class="n">FP</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">c</span> <span class="o">+</span> <span class="n">k</span>
    <span class="k">return</span> <span class="n">y</span> <span class="o">**</span> <span class="mi">3</span>

</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">qap</span> <span class="o">=</span> <span class="n">QAP</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">C</span><span class="p">)</span>
<span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="n">qap</span><span class="o">.</span><span class="n">qap</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">witness</span><span class="p">(</span><span class="n">FP</span><span class="p">(</span><span class="mi">89</span><span class="p">),</span> <span class="n">FP</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span> <span class="n">FP</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">R</span> <span class="o">=</span> <span class="n">RationalGenerator</span><span class="p">(</span><span class="n">FP</span><span class="p">,</span> <span class="n">ECG</span><span class="p">,</span> <span class="n">ECG</span><span class="p">,</span> <span class="n">ECG</span><span class="p">,</span> <span class="n">ECG</span><span class="o">.</span><span class="n">e</span><span class="p">,</span> <span class="n">ECG</span><span class="o">.</span><span class="n">G1</span><span class="p">,</span> <span class="n">ECG</span><span class="o">.</span><span class="n">G2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="(\sigma,\tau)-\leftarrow-Setup(R):">
<h2><span class="math notranslate nohighlight">\((\sigma,\tau) \leftarrow Setup(R)\)</span>:<a class="headerlink" href="#(\sigma,\tau)-\leftarrow-Setup(R):" title="Permalink to this headline">¶</a></h2>
<p>Pick <span class="math notranslate nohighlight">\(\alpha, \beta, \gamma, \delta, x \leftarrow \mathbb{Z}_P^*\)</span>, Define <span class="math notranslate nohighlight">\(\tau = (\alpha, \beta, \gamma, \delta, x)\)</span> and compute <span class="math notranslate nohighlight">\(\sigma = ([\mathbf{\sigma_1}]_1, [\mathbf{\sigma_2}]_2\)</span> where</p>
<div class="math notranslate nohighlight">
\[\begin{split}(\mathbf{\sigma}_1, \mathbf{\sigma}_2) = \left( \left(\begin{split}
\alpha, \beta, \delta, \{x^i\}_{i=0}^{n-1},
\left\{\frac{\beta u_i(x) + \alpha v_i (x) + w_i (x)}{\gamma} \right\}_{i=0}^l \\
\left\{ \frac{\beta u_i (x) + \alpha v_i(x) + w_i(x)}{\delta} \right\}_{i=l+1}^m,
\left\{\frac{x^i t(x)}{\delta} \right \}_{i=0}^{n-2}
\end{split}\right) , \left(\beta, \gamma, \delta, \{x^i\}^{n-1}_{i=0} \right)
\right)\end{split}\]</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Type</span>
<span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">add</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">reduce</span>

<span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Iterable</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">R</span><span class="o">.</span><span class="n">G1</span><span class="p">,</span> <span class="n">R</span><span class="o">.</span><span class="n">G2</span><span class="p">]]:</span>
    <span class="n">tau</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> \
        <span class="n">randfield</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">F</span><span class="p">),</span> <span class="n">randfield</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">F</span><span class="p">),</span> <span class="n">randfield</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">F</span><span class="p">),</span> <span class="n">randfield</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">F</span><span class="p">),</span> <span class="n">randfield</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">F</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">U</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">degree</span>
    <span class="n">sigma_1</span> <span class="o">=</span> <span class="p">[</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">delta</span><span class="p">]</span> <span class="o">+</span> \
              <span class="p">[</span><span class="n">x</span> <span class="o">**</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)]</span> <span class="o">+</span> \
              <span class="p">[(</span><span class="n">R</span><span class="o">.</span><span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">](</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">beta</span> <span class="o">+</span> <span class="n">R</span><span class="o">.</span><span class="n">V</span><span class="p">[</span><span class="n">i</span><span class="p">](</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span> <span class="o">+</span> <span class="n">R</span><span class="o">.</span><span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">](</span><span class="n">x</span><span class="p">))</span> <span class="o">/</span> <span class="n">gamma</span>  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">R</span><span class="o">.</span><span class="n">l</span><span class="p">)]</span> <span class="o">+</span> \
              <span class="p">[(</span><span class="n">R</span><span class="o">.</span><span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">](</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">beta</span> <span class="o">+</span> <span class="n">R</span><span class="o">.</span><span class="n">V</span><span class="p">[</span><span class="n">i</span><span class="p">](</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span> <span class="o">+</span> <span class="n">R</span><span class="o">.</span><span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">](</span><span class="n">x</span><span class="p">))</span> <span class="o">/</span> <span class="n">delta</span>  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">)]</span> <span class="o">+</span> \
              <span class="p">[(</span><span class="n">x</span> <span class="o">**</span> <span class="n">i</span> <span class="o">*</span> <span class="n">R</span><span class="o">.</span><span class="n">T</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">/</span> <span class="n">delta</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
    <span class="n">sigma_2</span> <span class="o">=</span> <span class="p">[</span><span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">delta</span><span class="p">]</span> <span class="o">+</span> \
              <span class="p">[</span><span class="n">x</span><span class="o">**</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)]</span>

    <span class="n">sigma</span> <span class="o">=</span> <span class="p">([</span><span class="n">R</span><span class="o">.</span><span class="n">g</span> <span class="o">@</span> <span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sigma_1</span><span class="p">],</span> <span class="p">[</span><span class="n">R</span><span class="o">.</span><span class="n">h</span> <span class="o">@</span> <span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sigma_2</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">tau</span><span class="p">,</span> <span class="n">sigma</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tau</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="n">setup</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="\pi-\leftarrow-Prov(R,-\tau,-\sigma,-a_1,-\cdots,-a_m)">
<h2><span class="math notranslate nohighlight">\(\pi \leftarrow Prov(R, \tau, \sigma, a_1, \cdots, a_m)\)</span><a class="headerlink" href="#\pi-\leftarrow-Prov(R,-\tau,-\sigma,-a_1,-\cdots,-a_m)" title="Permalink to this headline">¶</a></h2>
<p>Pick <span class="math notranslate nohighlight">\(r, s \leftarrow \mathbb{Z}_p\)</span> and compute <span class="math notranslate nohighlight">\(\pi = ([A]_1, [C]_1, [B]_2\)</span> where</p>
<div class="math notranslate nohighlight">
\[A = \alpha + \sum_{i=0}^m a_i u_i(x) + r\delta\]</div>
<div class="math notranslate nohighlight">
\[B = \beta + \sum_{i=0}^m a_i v_i(x) + s\delta\]</div>
<div class="math notranslate nohighlight">
\[C = \frac{\sum_{i=l+1}^m a_i(\beta u_i(x) + \alpha v_i(x) + w_i(x)) + h(x)t(x)}{\delta} + As + Br - rs\delta\]</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">H</span> <span class="o">=</span> <span class="n">qap</span><span class="o">.</span><span class="n">H</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">prov</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">R</span><span class="o">.</span><span class="n">G1</span><span class="p">,</span> <span class="n">R</span><span class="o">.</span><span class="n">G1</span><span class="p">,</span> <span class="n">R</span><span class="o">.</span><span class="n">G2</span><span class="p">]:</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">r</span> <span class="ow">or</span> <span class="n">randfield</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">F</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="ow">or</span> <span class="n">randfield</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">F</span><span class="p">)</span>
    <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">tau</span>
    <span class="n">m</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">+</span> <span class="n">reduce</span><span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">](</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">m</span><span class="p">)])</span> <span class="o">+</span> <span class="n">r</span> <span class="o">*</span> <span class="n">delta</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">beta</span> <span class="o">+</span> <span class="n">reduce</span><span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">V</span><span class="p">[</span><span class="n">i</span><span class="p">](</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">m</span><span class="p">)])</span> <span class="o">+</span> <span class="n">s</span> <span class="o">*</span> <span class="n">delta</span>
    <span class="n">C</span> <span class="o">=</span> <span class="p">(</span><span class="n">reduce</span><span class="p">(</span><span class="n">add</span><span class="p">,</span>
                <span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">beta</span> <span class="o">*</span> <span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">](</span><span class="n">x</span><span class="p">))</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">V</span><span class="p">[</span><span class="n">i</span><span class="p">](</span><span class="n">x</span><span class="p">))</span> <span class="o">+</span> <span class="n">R</span><span class="o">.</span><span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">](</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">)])</span> \
        <span class="o">+</span> <span class="n">H</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">R</span><span class="o">.</span><span class="n">T</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">/</span> <span class="n">delta</span> \
        <span class="o">+</span> <span class="p">(</span><span class="n">A</span> <span class="o">*</span> <span class="n">s</span> <span class="o">+</span> <span class="n">B</span> <span class="o">*</span> <span class="n">r</span> <span class="o">-</span> <span class="n">r</span> <span class="o">*</span> <span class="n">s</span> <span class="o">*</span> <span class="n">delta</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">g</span> <span class="o">@</span> <span class="n">A</span><span class="p">,</span> <span class="n">R</span><span class="o">.</span><span class="n">g</span> <span class="o">@</span> <span class="n">C</span><span class="p">,</span> <span class="n">R</span><span class="o">.</span><span class="n">h</span> <span class="o">@</span> <span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pi</span> <span class="o">=</span> <span class="n">prov</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="0/1-\leftarrow-Vfy(R,-\tau,-a_1,-\cdots,-a_l,-\pi)">
<h2><span class="math notranslate nohighlight">\(0/1 \leftarrow Vfy(R, \tau, a_1, \cdots, a_l, \pi)\)</span><a class="headerlink" href="#0/1-\leftarrow-Vfy(R,-\tau,-a_1,-\cdots,-a_l,-\pi)" title="Permalink to this headline">¶</a></h2>
<p>Parse <span class="math notranslate nohighlight">\(\pi = ([A]_1, [C]_1, [B]_2 \in G_1^2 x G_2\)</span>. Accept the proof iff:</p>
<div class="math notranslate nohighlight">
\[[A]_1 \circ [B]_2 = [\alpha]_1 \circ [\beta]_2 + \sum_{i=0}^l a_i \left[ \frac{\beta u_i(x) + \alpha v_i(x) + w_i(x)}{\gamma} \right]_1 \circ [\gamma]_2 + [C]_1 \circ [\delta]_2\]</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">vfy</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">pi</span><span class="p">):</span>
    <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">tau</span>
    <span class="n">A_1</span><span class="p">,</span> <span class="n">C_1</span><span class="p">,</span> <span class="n">B_2</span> <span class="o">=</span> <span class="n">pi</span>
    <span class="n">lhs</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">e</span><span class="p">(</span><span class="n">A_1</span><span class="p">,</span> <span class="n">B_2</span><span class="p">)</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">g</span> <span class="o">@</span> <span class="p">(</span><span class="n">reduce</span><span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="p">[</span>
                <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">beta</span> <span class="o">*</span> <span class="n">R</span><span class="o">.</span><span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">](</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">R</span><span class="o">.</span><span class="n">V</span><span class="p">[</span><span class="n">i</span><span class="p">](</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">R</span><span class="o">.</span><span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">](</span><span class="n">x</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">R</span><span class="o">.</span><span class="n">l</span><span class="p">)])</span> <span class="o">/</span> <span class="n">gamma</span><span class="p">)</span>
    <span class="n">rhs</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">e</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">g</span> <span class="o">@</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">R</span><span class="o">.</span><span class="n">h</span> <span class="o">@</span> <span class="n">beta</span><span class="p">)</span> <span class="o">*</span> \
          <span class="n">R</span><span class="o">.</span><span class="n">e</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">R</span><span class="o">.</span><span class="n">h</span> <span class="o">@</span> <span class="n">gamma</span><span class="p">)</span> <span class="o">*</span> \
          <span class="n">R</span><span class="o">.</span><span class="n">e</span><span class="p">(</span><span class="n">C_1</span><span class="p">,</span> <span class="n">R</span><span class="o">.</span><span class="n">h</span> <span class="o">@</span> <span class="n">delta</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lhs</span> <span class="o">==</span> <span class="n">rhs</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">vfy</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">pi</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
</div>
<div class="section" id="Explain">
<h2>Explain<a class="headerlink" href="#Explain" title="Permalink to this headline">¶</a></h2>
<p>On <span class="math notranslate nohighlight">\(Prov\)</span> phase:</p>
<div class="math notranslate nohighlight">
\begin{aligned}
A &amp;= \alpha + \sum_{i=0}^m a_i u_i(x) + r\delta \\
&amp;= \alpha + A_{qap} + r\delta
\end{aligned}</div><div class="math notranslate nohighlight">
\begin{aligned}
C &amp;= \frac{\sum_{i=l+1}^m a_i(\beta u_i(x) + \alpha v_i(x) + w_i(x)) + h(x)t(x)}{\delta} + As + Br - rs\delta\\
&amp;= \frac{1}{\delta} \sum_{i=l+1}^m \left(a_i(\beta u_i(x) + \alpha v_i(x) + w_i(x)) + h(x)t(x)\right) + As + Br - rs\delta \\
&amp;=\frac{\beta}{\delta}\sum_{i=l+1}^m a_i u_i(x) + \frac{\alpha}{\delta} \sum_{i=l+1}^m a_i v_i(x) +\frac{1}{\delta} w(x)t(x)+
\frac{1}{\delta} \sum_{i=l+1}^m h(x)t(x) + As + Br - rs \delta \\
&amp;=\frac{\beta}{\delta}A_{qap_{l+1, m}}+ \frac{\alpha}{\delta} B_{qap_{l+1, m}} +
\frac{1}{\delta} H_{qap}T_{qap} + s\alpha + sA_{qap} + sr\delta + r\beta + B_{qap}(x) + rs\delta - rs \delta \\
&amp;=\frac{\beta}{\delta}A_{qap_{l+1, m}}+ \frac{\alpha}{\delta} B_{qap_{l+1, m}} + \frac{1}{\delta} C_{qap_{l+1, m}} +
\frac{1}{\delta} H_{qap}T_{qap} + s\alpha + r\beta + sA_{qap} + rB_{qap} + sr\delta
\end{aligned}</div><div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">A_1</span><span class="p">,</span> <span class="n">C_1</span><span class="p">,</span> <span class="n">B_2</span> <span class="o">=</span> <span class="n">prov</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">tau</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">A_qap</span><span class="p">,</span> <span class="n">B_qap</span><span class="p">,</span> <span class="n">C_qap</span><span class="p">,</span> <span class="n">T_qap</span><span class="p">,</span> <span class="n">H_qap</span> <span class="o">=</span> <span class="n">qap</span><span class="o">.</span><span class="n">proof</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">A_qap</span> <span class="o">*</span> <span class="n">B_qap</span> <span class="o">==</span> <span class="n">C_qap</span> <span class="o">+</span> <span class="n">T_qap</span> <span class="o">*</span> <span class="n">H_qap</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">A_qap_l2m</span><span class="p">,</span> <span class="n">B_qap_l2m</span><span class="p">,</span> <span class="n">C_qap_l2m</span><span class="p">,</span> <span class="n">T_qap_l2m</span><span class="p">,</span> <span class="n">H_qap_l2m</span> <span class="o">=</span> <span class="n">qap</span><span class="o">.</span><span class="n">proof</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">R</span><span class="o">.</span><span class="n">l</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">A_qap_02l</span><span class="p">,</span> <span class="n">B_qap_02l</span><span class="p">,</span> <span class="n">C_qap_02l</span><span class="p">,</span> <span class="n">T_qap_02l</span><span class="p">,</span> <span class="n">H_qap_02l</span> <span class="o">=</span> <span class="n">qap</span><span class="o">.</span><span class="n">proof</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">R</span><span class="o">.</span><span class="n">l</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">assert</span> <span class="n">A_qap_l2m</span> <span class="o">+</span> <span class="n">A_qap_02l</span> <span class="o">==</span> <span class="n">A_qap</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">assert</span> <span class="n">A_1</span> <span class="o">==</span> <span class="n">R</span><span class="o">.</span><span class="n">g</span> <span class="o">@</span> <span class="p">(</span><span class="n">alpha</span> <span class="o">+</span> <span class="n">A_qap</span> <span class="o">+</span> <span class="n">r</span> <span class="o">*</span> <span class="n">delta</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">B_2</span> <span class="o">==</span> <span class="n">R</span><span class="o">.</span><span class="n">h</span> <span class="o">@</span> <span class="p">(</span><span class="n">beta</span> <span class="o">+</span> <span class="n">B_qap</span> <span class="o">+</span> <span class="n">s</span> <span class="o">*</span> <span class="n">delta</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">C_1</span> <span class="o">==</span> <span class="n">R</span><span class="o">.</span><span class="n">g</span> <span class="o">@</span> <span class="p">(</span><span class="n">beta</span> <span class="o">/</span> <span class="n">delta</span> <span class="o">*</span> <span class="n">A_qap_l2m</span> <span class="o">+</span> <span class="n">alpha</span><span class="o">/</span><span class="n">delta</span> <span class="o">*</span> <span class="n">B_qap_l2m</span> <span class="o">+</span> \
                     <span class="n">C_qap_l2m</span> <span class="o">/</span> <span class="n">delta</span> <span class="o">+</span> <span class="n">T_qap</span> <span class="o">*</span> <span class="n">H_qap</span> <span class="o">/</span> <span class="n">delta</span> <span class="o">+</span> \
                    <span class="n">s</span> <span class="o">*</span> <span class="n">alpha</span> <span class="o">+</span> <span class="n">r</span> <span class="o">*</span> <span class="n">beta</span> <span class="o">+</span> <span class="n">s</span> <span class="o">*</span> <span class="n">A_qap</span> <span class="o">+</span> <span class="n">r</span> <span class="o">*</span> <span class="n">B_qap</span> <span class="o">+</span> <span class="n">s</span> <span class="o">*</span> <span class="n">r</span> <span class="o">*</span> <span class="n">delta</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>On Vry phase, for RHS</p>
<div class="math notranslate nohighlight">
\begin{aligned}
Rhs &amp;= \underline{[\alpha]_1 \circ [\beta]_2}_{P1} + \underline{\sum_{i=0}^l a_i \left[ \frac{\beta u_i(x) + \alpha v_i(x) + w_i(x)}{\gamma} \right]_1 \circ [\gamma]_2}_{P2} + \underline{[C]_1 \circ [\delta]_2}_{P3}\\\\\\
P1 &amp; = [\alpha]_1[\beta]_2 = [\alpha \beta]_1[1]_2\\
P2 &amp;= \sum_{i=0}^l a_i \left[ \frac{\beta u_i(x) + \alpha v_i(x) + w_i(x)}{\gamma} \right]_1\\
&amp;= \left[ \frac{\beta}{\gamma} A_{qap_{0,l}} + \frac{\alpha}{\gamma} B_{qap_{0,l}} + \frac{1}{\gamma}C_{qap{0,l}} \right]_1[\gamma]_2\\
&amp;= [\beta A_{qap_{0,l}} + \alpha B_{qap_{0,l}} + C_{qap_{0, l}}]_1[1]_2\\\\\\
P3 &amp;= [\frac{\beta}{\delta}A_{qap_{l+1, m}}+ \frac{\alpha}{\delta} B_{qap_{l+1, m}} + \frac{1}{\delta} C_{qap_{l+1, m}} +
\frac{1}{\delta} H_{qap}T_{qap} + s\alpha + r\beta + sA_{qap} + rB_{qap} + sr\delta]_1[\delta]_2 \\
&amp;= [\beta A_{qap_{l+1, m}}+\alpha B_{qap_{l+1, m}}+C_{qap_{l+1, m}}+H_{qap}T_{qap}+s\alpha\delta + r\beta\delta + s\delta A_{qap} + r\delta B_{qap} + sr\delta^2]_1[1]_2 \\
\end{aligned}</div><div class="math notranslate nohighlight">
\begin{aligned}
P1 + P2 + P3 &amp;= [\alpha\beta + \beta A_{qap_{0,l}} + \alpha B_{qap_{0,l}} + C_{qap_{0, l}} + \beta A_{qap_{l+1, m}}+\alpha B_{qap_{l+1, m}}+C_{qap_{l+1, m}}+H_{qap}T_{qap}+s\alpha\delta + r\beta\delta + s\delta A_{qap} + r\delta B_{qap} + sr\delta^2]_1[1]_2\\
&amp;= [\alpha\beta + \beta A_{qap} + \alpha B_{qap} + C_{qap} + H_{qap}T_{qap} + s\alpha\delta + r\beta\delta + s\delta A_{qap} + r\delta B_{qap} + sr\delta^2]_1  [1]_2
\end{aligned}</div><p>on <em>LHS</em></p>
<div class="math notranslate nohighlight">
\begin{aligned}
Lhs &amp;= [A]_1 \circ [B]_2 \\
    &amp;= [\alpha + A_{qap} + r\delta]_1 \circ [\beta + B_{qap} + s\delta]_2\\
    &amp;= [(\alpha + A_{qap} + r\delta)(\beta + B_{qap} + s\delta)]_1[1]_2
\end{aligned}</div><p>We knows that</p>
<div class="math notranslate nohighlight">
\[A_{qap}B_{qap} = C_{qap} + H_{qap}C_{qap}\]</div>
<p>so</p>
<div class="math notranslate nohighlight">
\begin{aligned}
Rhs &amp;= [\alpha\beta + \beta A_{qap} + \alpha B_{qap} + A_{qap}B_{qap} + s\delta A_{qap} + r\delta B_{qap} + s\alpha\delta + r\beta\delta  + sr\delta^2]_1 [1]_2\\
&amp;= [(\alpha + A_{qap} + r\delta)(\beta + B_{qap} + s\delta)]_1[1]_2
\end{aligned}</div><div class="math notranslate nohighlight">
\[Lhs = Rhs\]</div>
</div>
</div>


          </div>
          
        </div>
      </div>
    <a href="https://github.com/oxor-io/zkp-playground">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub">
    </a>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">zkp-playground</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="README.html">TL;DR</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Non-interactive%20and%20Reusable%20Non-malleable%20Commitment%20Schemes.html">Non-interactive and Reusable Non-malleable Commitment Schemes</a></li>
<li class="toctree-l1"><a class="reference internal" href="Pedersen%20Commitment.html">Pedersen Commitment</a></li>
<li class="toctree-l1"><a class="reference internal" href="On%20Sigma%20Protocols.html"><span class="math notranslate nohighlight">\(\Sigma\)</span> Protocols</a></li>
<li class="toctree-l1"><a class="reference internal" href="Abstract%20Algebra%20Types.html">Abstract Algebra Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="Homomorphic%20Encryption.html">Homomorphic Encryption</a></li>
<li class="toctree-l1"><a class="reference internal" href="From%20ZK%20to%20Bulletproofs.html">From ZK to Bulletproofsproof via Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="Paillier%27s%20encryption%20Scheme.html">Paillier’s encryption Scheme</a></li>
<li class="toctree-l1"><a class="reference internal" href="ElGamal.html">ElGamal</a></li>
<li class="toctree-l1"><a class="reference internal" href="Shamir%27s%20secret%20sharing%20scheme.html">Shamir’s secret sharing scheme</a></li>
<li class="toctree-l1"><a class="reference internal" href="Trapdoor%20Commitment%20Schemes.html">Discrete-Logarithm-Based Trapdoor Commitment Schemes</a></li>
<li class="toctree-l1"><a class="reference internal" href="Threshold%20ECDSA.html">Threshold ECDSA</a></li>
<li class="toctree-l1"><a class="reference internal" href="POD-Mini%20and%20POD-AS.html">POD-Mini and POD-AS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Damgard-Jurik%20Scheme%20of%20Paillier.html">Damgard-Jurik Scheme of Paillier</a></li>
<li class="toctree-l1"><a class="reference internal" href="Threshold%20Paillier%20Cryptosystem.html">Threshold Paillier Cryptosystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="R1CS%20to%20QAP.html">R1CS to QAP</a></li>
<li class="toctree-l1"><a class="reference internal" href="MimbleWimble.html">Play MimbleWimble with zkp-playground</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Groth16 in zkp-playground</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="autoapi/index.html">API Reference</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="MimbleWimble.html" title="previous chapter">Play MimbleWimble with zkp-playground</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Ryan Kung.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.4.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/Groth16.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>